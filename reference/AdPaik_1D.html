<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>One-Dimensional Analysis of log-Likelihood Function — AdPaik_1D • TimeDepFrail</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="One-Dimensional Analysis of log-Likelihood Function — AdPaik_1D"><meta name="description" content="Function for studying the log-likelihood function from the point of view of a single parameter and, therefore,
in a single direction.
It performs both the optimization of the log-likelihood with respect to this parameter and the
evaluation of the log-likelihood in several samples of the same parameter, while the other parameters can assume a constant assigned value or
can vary in their range."><meta property="og:description" content="Function for studying the log-likelihood function from the point of view of a single parameter and, therefore,
in a single direction.
It performs both the optimization of the log-likelihood with respect to this parameter and the
evaluation of the log-likelihood in several samples of the same parameter, while the other parameters can assume a constant assigned value or
can vary in their range."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TimeDepFrail</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>One-Dimensional Analysis of log-Likelihood Function</h1>

      <div class="d-none name"><code>AdPaik_1D.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function for studying the log-likelihood function from the point of view of a single parameter and, therefore,
in a single direction.
It performs both the optimization of the log-likelihood with respect to this parameter and the
evaluation of the log-likelihood in several samples of the same parameter, while the other parameters can assume a constant assigned value or
can vary in their range.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AdPaik_1D</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">time_axis</span>,</span>
<span>  <span class="va">index_param_to_vary</span>,</span>
<span>  flag_optimal_params <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optimal_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">categories_range_min</span>,</span>
<span>  <span class="va">categories_range_max</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  tol_optimize <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  flag_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  cex_max <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  color_bg <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  color_max_bg <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">21</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Formula object indicating the response variable, the covariates and the cluster variable.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Dataset in which the variables of the formula object are located.</p></dd>


<dt id="arg-time-axis">time_axis<a class="anchor" aria-label="anchor" href="#arg-time-axis"></a></dt>
<dd><p>Partitioned time-domain.</p></dd>


<dt id="arg-index-param-to-vary">index_param_to_vary<a class="anchor" aria-label="anchor" href="#arg-index-param-to-vary"></a></dt>
<dd><p>Index of the parameter, in the parameter vector, with respect to which the log-likelihood function
is maximized in a one-dimensional way. The index s provided to identify the parameter under consideration inside the vector, avoiding
providing its name or value.</p></dd>


<dt id="arg-flag-optimal-params">flag_optimal_params<a class="anchor" aria-label="anchor" href="#arg-flag-optimal-params"></a></dt>
<dd><p>Are the other parameters extracted from the optimal vector of parameters? If so, the flag should be equal to TRUE.
Otherwise, the flag is equal to FALSE.</p></dd>


<dt id="arg-optimal-params">optimal_params<a class="anchor" aria-label="anchor" href="#arg-optimal-params"></a></dt>
<dd><p>Vector of optimal parameters, determined through an entire multi-dimensional maximization
of the log-likelihood function. The default value (NULL) indicates that no vector is provided
and the parameters are randomly extracted in their range.</p></dd>


<dt id="arg-categories-range-min">categories_range_min<a class="anchor" aria-label="anchor" href="#arg-categories-range-min"></a></dt>
<dd><p>Vector containing the minimum value assumed by each parameter category.</p></dd>


<dt id="arg-categories-range-max">categories_range_max<a class="anchor" aria-label="anchor" href="#arg-categories-range-max"></a></dt>
<dd><p>Vector containing the maximum value assumed by each parameter category.</p></dd>


<dt id="arg-n-iter">n_iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p>Number of times the one-dimensional analysis with respect to the indicated parameter must be executed.
Default value is 5. See details for more information.</p></dd>


<dt id="arg-tol-optimize">tol_optimize<a class="anchor" aria-label="anchor" href="#arg-tol-optimize"></a></dt>
<dd><p>Tolerance used in the optimize R function for the one-dimensional optimization
of the log-likelihood function.</p></dd>


<dt id="arg-flag-plot">flag_plot<a class="anchor" aria-label="anchor" href="#arg-flag-plot"></a></dt>
<dd><p>Logical value for plotting the trend of the log-likelihood function with respect to the parameter under consideration.
A plot for each iteration (n_iter) is reported. Defaults to FALSE.
Be careful that if the optimal parameters are provided, then the trend may be always the same and therefore it may be sufficient to
set n_iter = 1. On the other hand, if optimal parameters are not provided, then it is recommended to impose a higher n_iter.</p></dd>


<dt id="arg-n-points">n_points<a class="anchor" aria-label="anchor" href="#arg-n-points"></a></dt>
<dd><p>Number of internal points in which the log-likelihood function must be evaluated, to
plot it.</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>Dimension of the points in the plot.</p></dd>


<dt id="arg-cex-max">cex_max<a class="anchor" aria-label="anchor" href="#arg-cex-max"></a></dt>
<dd><p>Dimension of the optimal point in the plot.</p></dd>


<dt id="arg-color-bg">color_bg<a class="anchor" aria-label="anchor" href="#arg-color-bg"></a></dt>
<dd><p>Color used in the plot for the points.</p></dd>


<dt id="arg-color-max-bg">color_max_bg<a class="anchor" aria-label="anchor" href="#arg-color-max-bg"></a></dt>
<dd><p>Color used for the optimal point in the plot.</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>Shape to be used for the points.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If the flag for the plot has been activated, the function returns both the plot of the one-dimensional log-likelihood function and
a class S3 object. Otherwise, only a S3 object of class 'AdPaik_1D'.
This class object is composed of:</p><ul><li><p>numerical vector of length @n_iter containing the optimal estimated parameter.</p></li>
<li><p>numerical vector of length @n_iter containing the associated one-dimensional optimized log-likelihood value</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The one-dimensional analysis of the log-likelihood function can be performed in two ways, with two different aims and results:</p><ul><li><p>Keeping fixed the other parameters (all the parameters in the vector, except for the one under consideration) to their optimal
value (flag_optimal_params = TRUE), determined through the multi-dimensional optimization. In this way, the optimized value of the parameter
coincides with the one get with the general and global approach and, therefore, there is no need to repeat this procedure several times (n_iter = 1).
However, this approach is really useful if we want to check the trend the log-likelihood function and to observe if it increases, decreases or
is constant.</p></li>
<li><p>Letting the other parameters vary in their range (flag_optimal_params = FALSE). The optimized parameter value will always assume a different
value, because it depends on the value of the other parameters, and it is suggested to repeat the procedure several times (n_iter \(\geq\) 5),
so that it is possible to identify a precise existence region for such parameter</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Consider the 'Academic Dropout dataset'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data_dropout</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Define the variables needed for the model execution</span></span></span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">time_to_event</span> <span class="op">~</span> <span class="va">Gender</span> <span class="op">+</span> <span class="va">CFUP</span> <span class="op">+</span> <span class="fu">cluster</span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">time_axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.3</span>, <span class="fl">3.1</span>, <span class="fl">3.8</span>, <span class="fl">4.3</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">5.8</span>, <span class="fl">6.0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fl">1e-10</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Identify a parameter existence range</span></span></span>
<span class="r-in"><span><span class="va">categories_range_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">2</span>, <span class="va">eps</span>, <span class="va">eps</span>, <span class="va">eps</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">categories_range_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">eps</span>, <span class="fl">0.5</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">eps</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">index_param_to_vary</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">analysis_1D_opt</span> <span class="op">&lt;-</span> <span class="fu">AdPaik_1D</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data_dropout</span>,</span></span>
<span class="r-in"><span>                             <span class="va">time_axis</span>, <span class="va">index_param_to_vary</span>, </span></span>
<span class="r-in"><span>                             flag_optimal_params <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>                             optimal_params <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                             flag_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             <span class="va">categories_range_min</span>, <span class="va">categories_range_max</span>, </span></span>
<span class="r-in"><span>                             n_iter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="AdPaik_1D-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AdPaik_1D-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AdPaik_1D-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AdPaik_1D-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AdPaik_1D-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or Study the log-likelihood behaviour</span></span></span>
<span class="r-in"><span><span class="va">categories_range_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">2</span>, <span class="va">eps</span>, <span class="va">eps</span>, <span class="va">eps</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">categories_range_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">eps</span>, <span class="fl">0.4</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">eps</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">index_param_to_vary</span> <span class="op">&lt;-</span> <span class="fl">14</span></span></span>
<span class="r-in"><span><span class="co"># Call the main model</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="AdPaikModel.html">AdPaikModel</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data_dropout</span>, <span class="va">time_axis</span>,</span></span>
<span class="r-in"><span>                      <span class="va">categories_range_min</span>, <span class="va">categories_range_max</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in while (r &lt;= n_run &amp; actual_tol_ll &gt; tol_ll) {    if (verbose)         message(paste("Run ", r))    RemainingIndexes &lt;- RunIndexes[r, ]    UsedIndexes &lt;- c()    while (length(RemainingIndexes) != 0) {        index_to_vary &lt;- RemainingIndexes[1]        PosIndex &lt;- which(RemainingIndexes == index_to_vary)        RemainingIndexes &lt;- RemainingIndexes[-PosIndex]        UsedIndexes &lt;- c(UsedIndexes, index_to_vary)        result_optimize &lt;- suppressWarnings(optimize(ll_AdPaik_1D,             c(params_range_min[index_to_vary], params_range_max[index_to_vary]),             maximum = TRUE, tol = tol_optimize, index_to_vary,             params, dataset, centre, time_axis, dropout_matrix,             e_matrix))        params[index_to_vary] &lt;- result_optimize$maximum    }    global_optimal_params[r, ] &lt;- params    global_optimal_loglikelihood_run &lt;- ll_AdPaik_eval(params,         dataset, centre, time_axis, dropout_matrix, e_matrix)    global_optimal_loglikelihood[r] &lt;- global_optimal_loglikelihood_run    if (is.nan(global_optimal_loglikelihood_run))         stop("NaN value for the optimal log-likelihood value.")    if (print_previous_ll_values[1]) {        n_previous &lt;- print_previous_ll_values[2]        if (r &lt; n_previous)             if (verbose)                 message(paste("Global log-likelihood: ", global_optimal_loglikelihood[1:r]))            else if (verbose)                 message(paste("Global log-likelihood: ", global_optimal_loglikelihood[(r -                   n_previous + 1):r]))    }    actual_tol_ll &lt;- abs(ll_optimal - global_optimal_loglikelihood_run)    if (ll_optimal &lt; global_optimal_loglikelihood_run) {        ll_optimal &lt;- global_optimal_loglikelihood_run        optimal_run &lt;- r    }    r &lt;- r + 1}:</span> missing value where TRUE/FALSE needed</span>
<span class="r-in"><span><span class="va">analysis_1D_opt</span> <span class="op">&lt;-</span> <span class="fu">AdPaik_1D</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data_dropout</span>, <span class="va">time_axis</span>,</span></span>
<span class="r-in"><span>                             <span class="va">index_param_to_vary</span>, flag_optimal_params <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>                             flag_plot <span class="op">=</span> <span class="cn">TRUE</span>, optimal_params <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">OptimalParameters</span>,</span></span>
<span class="r-in"><span>                             <span class="va">categories_range_min</span>, <span class="va">categories_range_max</span>, n_iter <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'result' not found</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alessandra Ragni, Giulia Romani, Chiara Masci.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

